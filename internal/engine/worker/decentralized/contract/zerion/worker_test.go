package zerion_test

import (
	"context"
	"math/big"
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/common/hexutil"
	"github.com/rss3-network/node/config"
	source "github.com/rss3-network/node/internal/engine/protocol/ethereum"
	worker "github.com/rss3-network/node/internal/engine/worker/decentralized/contract/zerion"
	"github.com/rss3-network/node/provider/ethereum"
	"github.com/rss3-network/node/provider/ethereum/contract/zerion"
	"github.com/rss3-network/node/provider/ethereum/endpoint"
	workerx "github.com/rss3-network/node/schema/worker/decentralized"
	activityx "github.com/rss3-network/protocol-go/schema/activity"
	"github.com/rss3-network/protocol-go/schema/metadata"
	"github.com/rss3-network/protocol-go/schema/network"
	"github.com/rss3-network/protocol-go/schema/typex"
	"github.com/samber/lo"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/require"
)

func TestWorker_Zerion(t *testing.T) {
	t.Parallel()

	type arguments struct {
		task   *source.Task
		config *config.Module
	}

	testcases := []struct {
		name      string
		arguments arguments
		want      *activityx.Activity
		wantError require.ErrorAssertionFunc
	}{
		{
			name: "Swap MATIC and SAND on Polygon",
			arguments: struct {
				task   *source.Task
				config *config.Module
			}{
				task: &source.Task{
					Network: network.Polygon,
					ChainID: 137,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x4ed94e65d4258376d6b2dfc8f2472febda51e614dde8faab8ba099fa2a5a07b3"),
						ParentHash:   common.HexToHash("0x3c3e027ad78166e69b1ad7ffb6fb10ea88562b969cc7c639df1595b7a43ab4ce"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x144AEae662aEb1f871AC217bB310d241c0F50590"),
						Number:       lo.Must(new(big.Int).SetString("62957224", 0)),
						GasLimit:     30000000,
						GasUsed:      17097080,
						Timestamp:    1728759191,
						BaseFee:      lo.Must(new(big.Int).SetString("26", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
						From:      common.HexToAddress("0x3379846D6A75940944ddcC166b267C028E3ca21a"),
						Gas:       285808,
						GasPrice:  lo.Must(new(big.Int).SetString("30000000026", 10)),
						Hash:      common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
						Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000000000000102b3fa2c42150a3d00000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000520000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf36956830000000000000000000000000000000000000000000000017382252a9d3500000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf36956830000000000000000000000001111111254eeb25477b68fb85ed929f73a9605820000000000000000000000001111111254eeb25477b68fb85ed929f73a96058200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000000000000000000000000000e8f78dc253000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf36956830000000000000000000000000000000000000000000000017382252a9d35000000000000000000000000000000000000000000000000000104c5cd11fcfa9a0900000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001c0000000000000003b6d0340369582d2010b6ed950b571f4101e3bb9b554876f6963f2b100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("137", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x4ed94e65d4258376d6b2dfc8f2472febda51e614dde8faab8ba099fa2a5a07b3"),
						BlockNumber:       lo.Must(new(big.Int).SetString("62957224", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 4428271,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x6fc23ac1a"),
						GasUsed:           205706,

						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0xBbba073C31bF03b8ACf7c28EF0738DeCF3695683"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x0000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000017382252a9d350000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           159,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xBbba073C31bF03b8ACf7c28EF0738DeCF3695683"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000017382252a9d350000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           160,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xBbba073C31bF03b8ACf7c28EF0738DeCF3695683"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f"),
								common.HexToHash("0x000000000000000000000000369582d2010b6ed950b571f4101e3bb9b554876f"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000017382252a9d350000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           161,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000369582d2010b6ed950b571f4101e3bb9b554876f"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000106154473d8f191ce"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           162,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x369582d2010B6eD950B571F4101e3bB9b554876F"),
							Topics: []common.Hash{
								common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000010d0f70885e9640a45696000000000000000000000000000000000000000000017c429e988d08e1fa9487"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           163,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x369582d2010B6eD950B571F4101e3bB9b554876F"),
							Topics: []common.Hash{
								common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017382252a9d35000000000000000000000000000000000000000000000000000106154473d8f191ce0000000000000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           164,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0000000000000000000000000000000000001010"),
							Topics: []common.Hash{
								common.HexToHash("0xe6497e3ee548a3372136af2fcb0696db31fc6cf20260707645068bd3fe97f3c4"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000001010"),
								common.HexToHash("0x0000000000000000000000000d500b1d8e8ef31e21c99d1db9a6444d3adf1270"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000106154473d8f191ce0000000000000000000000000000000000000000007c683c25d387baf0c5787b00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000007c683b1fbe434717d3e6ad00000000000000000000000000000000000000000000000106154473d8f191cf"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           165,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"),
							Topics: []common.Hash{
								common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000106154473d8f191ce"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           166,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0000000000000000000000000000000000001010"),
							Topics: []common.Hash{
								common.HexToHash("0xe6497e3ee548a3372136af2fcb0696db31fc6cf20260707645068bd3fe97f3c4"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000001010"),
								common.HexToHash("0x0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000106154473d8f191ce00000000000000000000000000000000000000000000000106154473d8f191cf000000000000000000000000000000000000000000000000116faee16a5bb57000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000011784f355434d473e"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           167,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0000000000000000000000000000000000001010"),
							Topics: []common.Hash{
								common.HexToHash("0xe6497e3ee548a3372136af2fcb0696db31fc6cf20260707645068bd3fe97f3c4"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000001010"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000010400c7f905f3b7410000000000000000000000000000000000000000000000011784f355434d473e00000000000000000000000000000000000000000000000002f4564071bc575800000000000000000000000000000000000000000000000013842b5c3d598ffd00000000000000000000000000000000000000000000000106f51e3977b00e99"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           168,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0000000000000000000000000000000000001010"),
							Topics: []common.Hash{
								common.HexToHash("0xe6497e3ee548a3372136af2fcb0696db31fc6cf20260707645068bd3fe97f3c4"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000001010"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000002147c7ad2fdda8d00000000000000000000000000000000000000000000000013842b5c3d598ffd00000000000000000000000000000000000000000000095bafe56d575300814d000000000000000000000000000000000000000000000000116faee16a5bb57000000000000000000000000000000000000000000000095bb1f9e9d225fe5bda"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           169,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x4a183b7ED67B9E14b3f45Abfb2Cf44ed22c29E54"),
							Topics: []common.Hash{
								common.HexToHash("0x3d0ce9bfc3ed7d6862dbb28b2dea94561fe714a1b4d019aa8af39730d1ad7c3d"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000002147c7ad2fdda8d"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           170,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
							Topics: []common.Hash{
								common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
								common.HexToHash("0x000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf3695683"),
								common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000017382252a9d3500000000000000000000000000000000000000000000000000017382252a9d35000000000000000000000000000000000000000000000000000102b3fa2c42150a3d0000000000000000000000000000000000000000000000010400c7f905f3b74100000000000000000000000000000000000000000000000002147c7ad2fdda8d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf36956830000000000000000000000001111111254eeb25477b68fb85ed929f73a9605820000000000000000000000001111111254eeb25477b68fb85ed929f73a96058200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000000000000000000000000000000000000000000e8f78dc253000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000bbba073c31bf03b8acf7c28ef0738decf36956830000000000000000000000000000000000000000000000017382252a9d35000000000000000000000000000000000000000000000000000104c5cd11fcfa9a0900000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001c0000000000000003b6d0340369582d2010b6ed950b571f4101e3bb9b554876f6963f2b1000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           171,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0000000000000000000000000000000000001010"),
							Topics: []common.Hash{
								common.HexToHash("0x4dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000001010"),
								common.HexToHash("0x0000000000000000000000003379846d6a75940944ddcc166b267c028e3ca21a"),
								common.HexToHash("0x000000000000000000000000144aeae662aeb1f871ac217bb310d241c0f50590"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000015eca7cfbeb8000000000000000000000000000000000000000000000000000312cc7a4398fab800000000000000000000000000000000000000000000000047442f538e980b6a00000000000000000000000000000000000000000000000002fcdfd273da42b8000000000000000000000000000000000000000000000000475a1bfb5e56c36a"),
							BlockNumber:     lo.Must(new(big.Int).SetString("62957224", 0)),
							TransactionHash: common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
							Index:           172,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab"),
						TransactionIndex: 39,
					},
				},
				config: &config.Module{
					Network: network.Polygon,
					Endpoint: config.Endpoint{
						URL: endpoint.MustGet(network.Polygon),
					},
				},
			},
			want: &activityx.Activity{
				ID:       "0x05725b446bb2ea82709a5c7eaa3dd1adb0d6e82731379c01dc47d51017c270ab",
				Network:  network.Polygon,
				Index:    39,
				From:     "0x3379846D6A75940944ddcC166b267C028E3ca21a",
				To:       zerion.AddressRouter.String(),
				Type:     typex.ExchangeSwap,
				Platform: workerx.PlatformZerion.String(),
				Fee: &activityx.Fee{
					Amount:  lo.Must(decimal.NewFromString("6171180005348356")),
					Decimal: 18,
				},
				Calldata: &activityx.Calldata{
					FunctionHash: "0x83d13e01",
				},
				Actions: []*activityx.Action{
					{
						Type:     typex.TransactionTransfer,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x3379846D6A75940944ddcC166b267C028E3ca21a",
						To:       zerion.AddressRouter.String(),
						Metadata: metadata.TransactionTransfer{
							Value:    lo.ToPtr(lo.Must(decimal.NewFromString("149881554577775245"))),
							Name:     "Polygon",
							Symbol:   "MATIC",
							Decimals: 18,
						},
					},
					{
						Type:     typex.ExchangeSwap,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x3379846D6A75940944ddcC166b267C028E3ca21a",
						To:       "0x3379846D6A75940944ddcC166b267C028E3ca21a",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0xBbba073C31bF03b8ACf7c28EF0738DeCF3695683"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("26770000000000000000"))),
								Name:     "SAND",
								Symbol:   "SAND",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("18735194322221905729"))),
								Name:     "Polygon",
								Symbol:   "MATIC",
								Decimals: 18,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1728759191,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap USDT and ETH on Arbitrum",
			arguments: struct {
				task   *source.Task
				config *config.Module
			}{
				task: &source.Task{
					Network: network.Arbitrum,
					ChainID: 42161,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x1d9505a010cb198f6dff737a3a2986012eac06ffa73a834a734bcebc5134215f"),
						ParentHash:   common.HexToHash("0xcc1732aabc001c43c4fa9354351365558e777d536ce3a1722e69d636f7b2e62f"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0xA4b000000000000000000073657175656e636572"),
						Number:       lo.Must(new(big.Int).SetString("263095327", 0)),
						GasLimit:     1125899906842624,
						GasUsed:      3634354,
						Timestamp:    1728750926,
						BaseFee:      lo.Must(new(big.Int).SetString("10000000", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
						From:      common.HexToAddress("0x391Ab47760141CE520792bD58a4c7315689443Dd"),
						Gas:       1459448,
						GasPrice:  lo.Must(new(big.Int).SetString("10000000", 10)),
						Hash:      common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
						Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb900000000000000000000000000000000000000000000000000000000013cf21300000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000009c00000000000000000000000000000000000000000000000000000000000000a40000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000001e32b4789740000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e5400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000391ab47760141ce520792bd58a4c7315689443dd000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006e0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b50000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb90000000000000000000000000000000000000000000000000000000000000604e21fd0e9000000000000000000000000000000000000000000000000000000000000002000000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000000c00101000000290200000023c6690c352a030cf0d79963c9dc0e0759dedbf00000000000000000001e32b478974000010aeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000670aa9f2000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150000000000000000000000000141162b000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb90000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000001e32b47897400000000000000000000000000000000000000000000000000000000000013f7b2d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002247b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a2232312e3033393633353537373638333035222c22416d6f756e744f7574555344223a2232312e303335303339343831353931303637222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a223231303432373331222c2254696d657374616d70223a313732383735303931342c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a22577262386a42564a745563366777574a4e63724565446d4257377a65456f306739386877486f42744554614445587378724b536949747a42333132587571335642413377555a72712b456a44334662786d37687832634635792f66556b594d4644765367676d716774736a4a3573724d51327136366844586c5a4a48524c556c616c58514846504672714152625568426e2f786e75386f3130664d7859742f3150635a5854497033594f6a4c304c72466d5872767872594f63443452776f7733506656656e534a42423255747a434c615152424277664e59765662364c63434d6e386e645958766a652b37637574363935485a58476f7a433966786750586963657367386d55454f70733875595a684d51727838374b506862664b675a63593278394e52336f49584d643875514554667047507133795252646b4833535638705459333471673967482f2f397151776b7533466c78773d3d227d7d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
						Value:     lo.Must(new(big.Int).SetString("8500000000000000", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("42161", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x1d9505a010cb198f6dff737a3a2986012eac06ffa73a834a734bcebc5134215f"),
						BlockNumber:       lo.Must(new(big.Int).SetString("263095327", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 3464990,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x989680"),
						GasUsed:           1205161,

						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0x82aF49447D8a07e3bd95BD0d56f35241523fBab1"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000001e32b478974000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           15,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x00000000000000000000000023c6690c352a030cf0d79963c9dc0e0759dedbf0"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000141162b"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           16,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x82aF49447D8a07e3bd95BD0d56f35241523fBab1"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
								common.HexToHash("0x00000000000000000000000023c6690c352a030cf0d79963c9dc0e0759dedbf0"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000001e32b478974000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           17,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x23c6690C352a030cF0D79963C9dc0E0759DEDbf0"),
							Topics: []common.Hash{
								common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000001e32b478974000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffebee9d50000000000000000000000000000000000000000000342d903d70a2b0a23e2d100000000000000000000000000000000000000000000000000264adc023021f6fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffcf9e0"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           18,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x11ddD59C33c73C44733b4123a86Ea5ce57F6e854"),
							Topics: []common.Hash{
								common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000023c6690c352a030cf0d79963c9dc0e0759dedbf0000000000000000000000000000000000000000000000000000000000141162b000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           19,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000141162b"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           20,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
							Topics: []common.Hash{
								common.HexToHash("0xd6d4f5681c246c9f42c203e287975af1601f8df8035a9251f79aab5c8f09e2f8"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000001e32b478974000000000000000000000000000000000000000000000000000000000000141162b"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           21,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
							Topics: []common.Hash{
								common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854000000000000000000000000000000000000000000000000000000000141162b000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           22,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
							Topics: []common.Hash{
								common.HexToHash("0x095e66fa4dd6a6f7b43fb8444a7bd0edb870508c7abf639bc216efb0bcff9779"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002247b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a2232312e3033393633353537373638333035222c22416d6f756e744f7574555344223a2232312e303335303339343831353931303637222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a223231303432373331222c2254696d657374616d70223a313732383735303931342c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a22577262386a42564a745563366777574a4e63724565446d4257377a65456f306739386877486f42744554614445587378724b536949747a42333132587571335642413377555a72712b456a44334662786d37687832634635792f66556b594d4644765367676d716774736a4a3573724d51327136366844586c5a4a48524c556c616c58514846504672714152625568426e2f786e75386f3130664d7859742f3150635a5854497033594f6a4c304c72466d5872767872594f63443452776f7733506656656e534a42423255747a434c615152424277664e59765662364c63434d6e386e645958766a652b37637574363935485a58476f7a433966786750586963657367386d55454f70733875595a684d51727838374b506862664b675a63593278394e52336f49584d643875514554667047507133795252646b4833535638705459333471673967482f2f397151776b7533466c78773d3d227d7d00000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           23,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x000000000000000000000000391ab47760141ce520792bd58a4c7315689443dd"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000013e89ce"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           24,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000028c5d"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           25,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
							Topics: []common.Hash{
								common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
								common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
								common.HexToHash("0x000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000001e32b478974000000000000000000000000000000000000000000000000000001e32b47897400000000000000000000000000000000000000000000000000000000000013cf21300000000000000000000000000000000000000000000000000000000013e89ce0000000000000000000000000000000000000000000000000000000000028c5d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000391ab47760141ce520792bd58a4c7315689443dd0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e5400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000391ab47760141ce520792bd58a4c7315689443dd000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006e0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b50000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb90000000000000000000000000000000000000000000000000000000000000604e21fd0e9000000000000000000000000000000000000000000000000000000000000002000000000000000000000000011ddd59c33c73c44733b4123a86ea5ce57f6e854000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000000c00101000000290200000023c6690c352a030cf0d79963c9dc0e0759dedbf00000000000000000001e32b478974000010aeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000670aa9f2000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150000000000000000000000000141162b000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000fd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb90000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000001e32b47897400000000000000000000000000000000000000000000000000000000000013f7b2d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002247b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a2232312e3033393633353537373638333035222c22416d6f756e744f7574555344223a2232312e303335303339343831353931303637222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a223231303432373331222c2254696d657374616d70223a313732383735303931342c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a22577262386a42564a745563366777574a4e63724565446d4257377a65456f306739386877486f42744554614445587378724b536949747a42333132587571335642413377555a72712b456a44334662786d37687832634635792f66556b594d4644765367676d716774736a4a3573724d51327136366844586c5a4a48524c556c616c58514846504672714152625568426e2f786e75386f3130664d7859742f3150635a5854497033594f6a4c304c72466d5872767872594f63443452776f7733506656656e534a42423255747a434c615152424277664e59765662364c63434d6e386e645958766a652b37637574363935485a58476f7a433966786750586963657367386d55454f70733875595a684d51727838374b506862664b675a63593278394e52336f49584d643875514554667047507133795252646b4833535638705459333471673967482f2f397151776b7533466c78773d3d227d7d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("263095327", 0)),
							TransactionHash: common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
							Index:           26,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd"),
						TransactionIndex: 6,
					},
				},
				config: &config.Module{
					Network: network.Arbitrum,
					Endpoint: config.Endpoint{
						URL: endpoint.MustGet(network.Arbitrum),
					},
				},
			},
			want: &activityx.Activity{
				ID:       "0xf404356c97a2366e87ac4a0431fce21ecf747b473e58ee2d5e929cb774f6dfcd",
				Network:  network.Arbitrum,
				Index:    6,
				From:     "0x391Ab47760141CE520792bD58a4c7315689443Dd",
				To:       zerion.AddressRouter.String(),
				Type:     typex.ExchangeSwap,
				Platform: workerx.PlatformZerion.String(),
				Fee: &activityx.Fee{
					Amount:  lo.Must(decimal.NewFromString("12051610000000")),
					Decimal: 18,
				},
				Calldata: &activityx.Calldata{
					FunctionHash: "0x83d13e01",
				},
				Actions: []*activityx.Action{
					{
						Type:     typex.TransactionTransfer,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x391Ab47760141CE520792bD58a4c7315689443Dd",
						To:       zerion.AddressRouter.String(),
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
							Value:    lo.ToPtr(lo.Must(decimal.NewFromString("167005"))),
							Name:     "Tether USD",
							Symbol:   "USDT",
							Decimals: 6,
							Standard: metadata.StandardERC20,
						},
					},
					{
						Type:     typex.ExchangeSwap,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x391Ab47760141CE520792bD58a4c7315689443Dd",
						To:       "0x391Ab47760141CE520792bD58a4c7315689443Dd",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("8500000000000000"))),
								Name:     "Ethereum",
								Symbol:   "ETH",
								Decimals: 18,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("20875726"))),
								Name:     "Tether USD",
								Symbol:   "USDT",
								Decimals: 6,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1728750926,
			},
			wantError: require.NoError,
		},
		//{
		//	name: "Swap USDC and AVAX on AVAX",
		//	arguments: struct {
		//		task   *protocol.Task
		//		config *config.Module
		//	}{
		//		task: &protocol.Task{
		//			Network: network.Avalanche,
		//			ChainID: 43114,
		//			Header: &ethereum.Header{
		//				Hash:         common.HexToHash("0xea3898316826275ddc8e686d556feb55f12c185725764e7451c40ef9ba8951a1"),
		//				ParentHash:   common.HexToHash("0x68d9c597bc42da4ec7e2bbac5fa3c17fbf6c4597f465edb67844355ee0edd751"),
		//				UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
		//				Coinbase:     common.HexToAddress("0x0100000000000000000000000000000000000000"),
		//				Number:       lo.Must(new(big.Int).SetString("51695150", 0)),
		//				GasLimit:     15000000,
		//				GasUsed:      855846,
		//				Timestamp:    1728757714,
		//				BaseFee:      lo.Must(new(big.Int).SetString("25000000000", 0)),
		//				Transactions: nil,
		//			},
		//			Transaction: &ethereum.Transaction{
		//				BlockHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//				From:      common.HexToAddress("0xc94aefd85e0810C05Fd7bDE4d14D759B1756E759"),
		//				Gas:       898048,
		//				GasPrice:  lo.Must(new(big.Int).SetString("25000000000", 10)),
		//				Hash:      common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//				Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000610a2200000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000ea00000000000000000000000000000000000000000000000000000000000000f20000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000031126543f5c80000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c94aefd85e0810c05fd7bde4d14d759b1756e759000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000bc0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b50000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000000ae4e21fd0e90000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000660000000000000000000000000000000000000000000000000000000000000086000000000000000000000000000000000000000000000000000000000000005a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f00000000000000000000000000000000000000000000000000000000670ac47a0000000000000000000000000000000000000000000000000000000000000540000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000000040593611990000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000001000000000000000000000000006b00325bc678e0fbcbd7d4be4eb0785408860176000000000000000000000000b31f66aa3c1e785363f0875a1b74e27b85fd66c7000000000000000000000000c7198437980c041c805a1edcba50c1ce5db95118000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000000000000000000000000000000000040d90ce491000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000100000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd000000000000000000000000c7198437980c041c805a1edcba50c1ce5db95118000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000620fb60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000403b284cfe0000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000009ab2de34a33fb459b538c43f251eb825645e8595000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000005930bdeca7ff90ab000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd670000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000060000000000000000000000000062030e000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000000000000061d0df000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002227b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a22362e343336313631343536383937383939222c22416d6f756e744f7574555344223a22362e343533303831333237383531373632222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a2236343233333130222c2254696d657374616d70223a313732383735373730362c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a2262754e794d707154756a4e354762343050305945734d676746305930565250744d526b4979314f59566a6b57386e4c436c484d31714b3533494d7242576874676d6978487672494663426579546a434450327756634432364e50786a584b786c417257657a6e4730616275426d2f4566456a366558636c30422b4d374576396d7844424b52422b737059575867742b655a6c6f34772b446b356e465267556f786a7539634d492f2f784b72594e446c5a786262765056793538645a512f424d5941464232724954384a4c6174656b595346795a3630765965496b4f49364d734a4b3145527852343175474d6a414f32324f6c2f61676d416f376e4d396c724c4c473068744d62307441733935446b342f5044484d764b31667a767152456b6f664c59594a75303934796577624e46645273595a2f644b6f766a325451326b7975537075444272777368506b35767965416b30626752773d3d227d7d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
		//				To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
		//				Value:     lo.Must(new(big.Int).SetString("221000000000000000", 0)),
		//				Type:      2,
		//				ChainID:   lo.Must(new(big.Int).SetString("43114", 0)),
		//			},
		//			Receipt: &ethereum.Receipt{
		//				BlockHash:         common.HexToHash("0xea3898316826275ddc8e686d556feb55f12c185725764e7451c40ef9ba8951a1"),
		//				BlockNumber:       lo.Must(new(big.Int).SetString("51695150", 0)),
		//				ContractAddress:   nil,
		//				CumulativeGasUsed: 855846,
		//				EffectiveGasPrice: hexutil.MustDecodeBig("0x5d21dba00"),
		//				GasUsed:           808858,
		//
		//				Logs: []*ethereum.Log{{
		//					Address: common.HexToAddress("0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000031126543f5c8000"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           1,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x0000000000000000000000006b00325bc678e0fbcbd7d4be4eb0785408860176"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000031126543f5c8000"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           2,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xc7198437980c041c805A1EDcbA50c1Ce5db95118"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x0000000000000000000000006b00325bc678e0fbcbd7d4be4eb0785408860176"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000006215fe"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           3,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x6b00325bC678E0FBcbd7d4be4EB0785408860176"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000004936ddff3572b223600000000000000000000000000000000000000000000000000000000926600fc"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           4,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x6b00325bC678E0FBcbd7d4be4EB0785408860176"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000031126543f5c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006215fe"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           5,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xf081470f5C6FBCCF48cC4e5B82Dd926409DcdD67"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000006b00325bc678e0fbcbd7d4be4eb078540886017600000000000000000000000000000000000000000000000000000000006215fe000000000000000000000000c7198437980c041c805a1edcba50c1ce5db95118"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           6,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xc7198437980c041c805A1EDcbA50c1Ce5db95118"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd"),
		//					},
		//					Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000006215fe"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           7,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xc7198437980c041c805A1EDcbA50c1Ce5db95118"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd"),
		//					},
		//					Data:            hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffffffffffff8a3fbe9991"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           8,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x130966628846BFd36ff31a822705796e8cb8C18D"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           9,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xAEA2E71b631fA93683BCF256A8689dFa0e094fcD"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x8b3e96f2b889fa771c53c981b40daf005f63f637f1869f707052d15a3dd97140"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000006215fe00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           10,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xf081470f5C6FBCCF48cC4e5B82Dd926409DcdD67"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd0000000000000000000000000000000000000000000000005939e1965567cc24000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           11,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x130966628846BFd36ff31a822705796e8cb8C18D"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x0000000000000000000000009ab2de34a33fb459b538c43f251eb825645e8595"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           12,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x47cd9dda0e50ce30bcaaacd0488452b596221c07ac402a581cfae4d3933cac2b"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000084f822f61b2e36d8c0000000000000000000000000000000000000000000000000000000000000000000a0c"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           13,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x64243679a443432e2293343b77d411ff6144370404618f00ca0d2025d9ca9882"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d0000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           14,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xe1e812596aac93a06ecc4ca627014d18e30f5c33b825160cc9d5c0ba61e45227"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           15,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x976177fbe09a15e5e43f848844963a42b41ef919ef17ff21a17a5421de8f4737"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d0000000000000000000000000000000000000000000000005939e1965567cc24"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           16,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x112726233fbeaeed0f5b1dba5cb0b2b81883dee49fb35ff99fd98ed9f6d31eb0"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000621ae9"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           17,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x0000000000000000000000009ab2de34a33fb459b538c43f251eb825645e8595"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//					},
		//					Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000006210dd"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           18,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x9ab2De34A33fB459b538c43f251eB825645e8595"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x0874b2d545cb271cdbda4e093020c452328b24af12382ed62c4d00f5c26709db"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000005939e1965567cc240000000000000000000000000000000000000000000000000000000000621ae900000000000000000000000000000000000000000000000000000000006210dd0000000000000000000000000000000000000000000000000000000000000004"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           19,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xf081470f5C6FBCCF48cC4e5B82Dd926409DcdD67"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000009ab2de34a33fb459b538c43f251eb825645e859500000000000000000000000000000000000000000000000000000000006210dd000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           20,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xf081470f5C6FBCCF48cC4e5B82Dd926409DcdD67"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x4bc8151c051441255339d01fbaeb38cf109cbfd75e9a5c62fb8f1dfb37fe6fd6"),
		//						common.HexToHash("0x0000000000000000000000004f82e73edb06d29ff62c91ec8f5ff06571bdeb29"),
		//						common.HexToHash("0x000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e"),
		//						common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000dd00000000000000000000000000000000000000000000000000000000000000000"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           21,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x0000000000000000000000004f82e73edb06d29ff62c91ec8f5ff06571bdeb29"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000dd0"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           22,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67"),
		//						common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000062030d"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           23,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xd6d4f5681c246c9f42c203e287975af1601f8df8035a9251f79aab5c8f09e2f8"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000000000000062030d"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           24,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddac40937f35385a34f721af292e5a83fc5b840f722bff57c2fc71adba708c48"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000000000000000000000000000000000000062030d000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           25,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0x6131B5fae19EA4f9D964eAc0408E4408b66337b5"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x095e66fa4dd6a6f7b43fb8444a7bd0edb870508c7abf639bc216efb0bcff9779"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002227b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a22362e343336313631343536383937383939222c22416d6f756e744f7574555344223a22362e343533303831333237383531373632222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a2236343233333130222c2254696d657374616d70223a313732383735373730362c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a2262754e794d707154756a4e354762343050305945734d676746305930565250744d526b4979314f59566a6b57386e4c436c484d31714b3533494d7242576874676d6978487672494663426579546a434450327756634432364e50786a584b786c417257657a6e4730616275426d2f4566456a366558636c30422b4d374576396d7844424b52422b737059575867742b655a6c6f34772b446b356e465267556f786a7539634d492f2f784b72594e446c5a786262765056793538645a512f424d5941464232724954384a4c6174656b595346795a3630765965496b4f49364d734a4b3145527852343175474d6a414f32324f6c2f61676d416f376e4d396c724c4c473068744d62307441733935446b342f5044484d764b31667a767152456b6f664c59594a75303934796577624e46645273595a2f644b6f766a325451326b7975537075444272777368506b35767965416b30626752773d3d227d7d000000000000000000000000000000000000000000000000000000000000"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           26,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
		//						common.HexToHash("0x000000000000000000000000c94aefd85e0810c05fd7bde4d14d759b1756e759"),
		//					},
		//					Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000613beb"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           27,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
		//						common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
		//						common.HexToHash("0x0000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c7"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000c722"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           28,
		//					Removed:         false,
		//				}, {
		//					Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
		//					Topics: []common.Hash{
		//						common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
		//						common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
		//						common.HexToHash("0x000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e"),
		//					},
		//					Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000031126543f5c80000000000000000000000000000000000000000000000000000000000000610a220000000000000000000000000000000000000000000000000000000000613beb000000000000000000000000000000000000000000000000000000000000c72200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000c94aefd85e0810c05fd7bde4d14d759b1756e7590000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c94aefd85e0810c05fd7bde4d14d759b1756e759000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000bc0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b50000000000000000000000006131b5fae19ea4f9d964eac0408e4408b66337b500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000000ae4e21fd0e90000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000660000000000000000000000000000000000000000000000000000000000000086000000000000000000000000000000000000000000000000000000000000005a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f00000000000000000000000000000000000000000000000000000000670ac47a0000000000000000000000000000000000000000000000000000000000000540000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000000040593611990000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000001000000000000000000000000006b00325bc678e0fbcbd7d4be4eb0785408860176000000000000000000000000b31f66aa3c1e785363f0875a1b74e27b85fd66c7000000000000000000000000c7198437980c041c805a1edcba50c1ce5db95118000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd67000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000000000000000000000000000000000040d90ce491000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000100000000000000000000000000aea2e71b631fa93683bcf256a8689dfa0e094fcd000000000000000000000000c7198437980c041c805a1edcba50c1ce5db95118000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000620fb60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000403b284cfe0000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000009ab2de34a33fb459b538c43f251eb825645e8595000000000000000000000000130966628846bfd36ff31a822705796e8cb8c18d000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000005930bdeca7ff90ab000000000000000000000000f081470f5c6fbccf48cc4e5b82dd926409dcdd670000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000060000000000000000000000000062030e000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000b97ef9ef8734c71904d8002f8b6bc66dd9c48a6e0000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000000000000000000000000000000000000000000031126543f5c8000000000000000000000000000000000000000000000000000000000000061d0df000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002227b22536f75726365223a227a6572696f6e222c22416d6f756e74496e555344223a22362e343336313631343536383937383939222c22416d6f756e744f7574555344223a22362e343533303831333237383531373632222c22526566657272616c223a22222c22466c616773223a302c22416d6f756e744f7574223a2236343233333130222c2254696d657374616d70223a313732383735373730362c22496e74656772697479496e666f223a7b224b65794944223a2231222c225369676e6174757265223a2262754e794d707154756a4e354762343050305945734d676746305930565250744d526b4979314f59566a6b57386e4c436c484d31714b3533494d7242576874676d6978487672494663426579546a434450327756634432364e50786a584b786c417257657a6e4730616275426d2f4566456a366558636c30422b4d374576396d7844424b52422b737059575867742b655a6c6f34772b446b356e465267556f786a7539634d492f2f784b72594e446c5a786262765056793538645a512f424d5941464232724954384a4c6174656b595346795a3630765965496b4f49364d734a4b3145527852343175474d6a414f32324f6c2f61676d416f376e4d396c724c4c473068744d62307441733935446b342f5044484d764b31667a767152456b6f664c59594a75303934796577624e46645273595a2f644b6f766a325451326b7975537075444272777368506b35767965416b30626752773d3d227d7d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
		//					BlockNumber:     lo.Must(new(big.Int).SetString("51695150", 0)),
		//					TransactionHash: common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//					Index:           29,
		//					Removed:         false,
		//				}},
		//				Status:           1,
		//				TransactionHash:  common.HexToHash("0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f"),
		//				TransactionIndex: 1,
		//			},
		//		},
		//		config: &config.Module{
		//			Network: network.Avalanche,
		//			Endpoint: config.Endpoint{
		//				URL: endpoint.MustGet(network.Avalanche),
		//			},
		//		},
		//	},
		//	want: &activityx.Activity{
		//		ID:       "0x62d811a6f282853c90b1abaf544dd9ffb027dd1c67a488582e024bca696b2e6f",
		//		Network:  network.Avalanche,
		//		Index:    1,
		//		From:     "0xc94aefd85e0810C05Fd7bDE4d14D759B1756E759",
		//		To:       zerion.AddressRouter.String(),
		//		Type:     typex.ExchangeSwap,
		//		Platform: workerx.PlatformZerion.String(),
		//		Fee: &activityx.Fee{
		//			Amount:  lo.Must(decimal.NewFromString("20221450000000000")),
		//			Decimal: 18,
		//		},
		//		Calldata: &activityx.Calldata{
		//			FunctionHash: "0x83d13e01",
		//		},
		//		Actions: []*activityx.Action{
		//			{
		//				Type:     typex.TransactionTransfer,
		//				Platform: workerx.PlatformZerion.String(),
		//				From:     "0xc94aefd85e0810C05Fd7bDE4d14D759B1756E759",
		//				To:       zerion.AddressRouter.String(),
		//				Metadata: metadata.TransactionTransfer{
		//					Address:  lo.ToPtr("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//					Value:    lo.ToPtr(lo.Must(decimal.NewFromString("50978"))),
		//					Name:     "USD Coin",
		//					Symbol:   "USDC",
		//					Decimals: 6,
		//					Standard: metadata.StandardERC20,
		//				},
		//			},
		//			{
		//				Type:     typex.ExchangeSwap,
		//				Platform: workerx.PlatformZerion.String(),
		//				From:     "0xc94aefd85e0810C05Fd7bDE4d14D759B1756E759",
		//				To:       "0xc94aefd85e0810C05Fd7bDE4d14D759B1756E759",
		//				Metadata: metadata.ExchangeSwap{
		//					From: metadata.Token{
		//						Value:    lo.ToPtr(lo.Must(decimal.NewFromString("221000000000000000"))),
		//						Name:     "Avalanche",
		//						Symbol:   "AVAX",
		//						Decimals: 18,
		//					},
		//					To: metadata.Token{
		//						Address:  lo.ToPtr("0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E"),
		//						Value:    lo.ToPtr(lo.Must(decimal.NewFromString("6372331"))),
		//						Name:     "USD Coin",
		//						Symbol:   "USDC",
		//						Decimals: 6,
		//						Standard: metadata.StandardERC20,
		//					},
		//				},
		//			},
		//		},
		//		Status:    true,
		//		Timestamp: 1728757714,
		//	},
		//	wantError: require.NoError,
		// },
		{
			name: "Swap ETH and USDC on Optimism",
			arguments: struct {
				task   *source.Task
				config *config.Module
			}{
				task: &source.Task{
					Network: network.Optimism,
					ChainID: 10,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x4eb9c164aa0cc3d84f4d5630e714f0bcaa371391f87ac1ea318fac4bbb537f5a"),
						ParentHash:   common.HexToHash("0x0b13a21ae721c0882435dc259e0744777b976b653081220f3e05fb58cd89a71a"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x4200000000000000000000000000000000000011"),
						Number:       lo.Must(new(big.Int).SetString("126581253", 0)),
						GasLimit:     30000000,
						GasUsed:      3769400,
						Timestamp:    1728761283,
						BaseFee:      lo.Must(new(big.Int).SetString("6590798", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
						From:      common.HexToAddress("0x4F847d8143f948D7572511C6C81BA543289F3baC"),
						Gas:       289116,
						GasPrice:  lo.Must(new(big.Int).SetString("7590798", 10)),
						Hash:      common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
						Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff8500000000000000000000000000000000000000000000000000000000000f409300000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000540000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000174e4905ba0000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004f847d8143f948d7572511c6c81ba543289f3bac000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff850000000000000000000000000000000000000000000000000000000000000104414bf38900000000000000000000000042000000000000000000000000000000000000060000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff8500000000000000000000000000000000000000000000000000000000000001f4000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f00000000000000000000000000000000000000000000000000000000670ad4c3000000000000000000000000000000000000000000000000000174e4905ba000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
						Value:     lo.Must(new(big.Int).SetString("410000000000000", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("10", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x4eb9c164aa0cc3d84f4d5630e714f0bcaa371391f87ac1ea318fac4bbb537f5a"),
						BlockNumber:       lo.Must(new(big.Int).SetString("126581253", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 1403845,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x73d38e"),
						GasUsed:           216881,
						L1GasPrice:        lo.Must(new(big.Int).SetString("8573069301", 0)),
						L1GasUsed:         lo.Must(new(big.Int).SetString("5287", 0)),
						L1Fee:             lo.Must(new(big.Int).SetString("236958127201", 0)),

						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x0000000000000000000000001fb3cf6e48f1e7b10213e7b6d87d4c073c7fdb7b"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000000f7396"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           19,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x4200000000000000000000000000000000000006"),
							Topics: []common.Hash{
								common.HexToHash("0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c"),
								common.HexToHash("0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000174e4905ba000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           20,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x4200000000000000000000000000000000000006"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564"),
								common.HexToHash("0x0000000000000000000000001fb3cf6e48f1e7b10213e7b6d87d4c073c7fdb7b"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000174e4905ba000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           21,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x1fb3cf6e48F1E7B10213E7b6d87D4c073C7Fdb7b"),
							Topics: []common.Hash{
								common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
								common.HexToHash("0x000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffff08c6a000000000000000000000000000000000000000000000000000174e4905ba0000000000000000000000000000000000000004e94c0a03d53e70e760378deeae5000000000000000000000000000000000000000000000000061e5b6b1f7a7bdf0000000000000000000000000000000000000000000000000000000000030634"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           22,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000004f847d8143f948d7572511c6c81ba543289f3bac"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000000f5432"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           23,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c7"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000001f64"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           24,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
							Topics: []common.Hash{
								common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
								common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
								common.HexToHash("0x0000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff85"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000174e4905ba000000000000000000000000000000000000000000000000000000174e4905ba00000000000000000000000000000000000000000000000000000000000000f409300000000000000000000000000000000000000000000000000000000000f54320000000000000000000000000000000000000000000000000000000000001f64000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000004f847d8143f948d7572511c6c81ba543289f3bac0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004f847d8143f948d7572511c6c81ba543289f3bac000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff850000000000000000000000000000000000000000000000000000000000000104414bf38900000000000000000000000042000000000000000000000000000000000000060000000000000000000000000b2c639c533813f4aa9d7837caf62653d097ff8500000000000000000000000000000000000000000000000000000000000001f4000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f00000000000000000000000000000000000000000000000000000000670ad4c3000000000000000000000000000000000000000000000000000174e4905ba0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("126581253", 0)),
							TransactionHash: common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
							Index:           25,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85"),
						TransactionIndex: 5,
					},
				},
				config: &config.Module{
					Network: network.Optimism,
					Endpoint: config.Endpoint{
						URL: endpoint.MustGet(network.Optimism),
					},
				},
			},
			want: &activityx.Activity{
				ID:       "0xe40d8914af296923721028595cb2cc36bc0ed006bbc1e924510c7fcde4d25f85",
				Network:  network.Optimism,
				Index:    5,
				From:     "0x4F847d8143f948D7572511C6C81BA543289F3baC",
				To:       zerion.AddressRouter.String(),
				Type:     typex.ExchangeSwap,
				Platform: workerx.PlatformZerion.String(),
				Fee: &activityx.Fee{
					Amount:  lo.Must(decimal.NewFromString("1883257988239")),
					Decimal: 18,
				},
				Calldata: &activityx.Calldata{
					FunctionHash: "0x83d13e01",
				},
				Actions: []*activityx.Action{
					{
						Type:     typex.TransactionTransfer,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x4F847d8143f948D7572511C6C81BA543289F3baC",
						To:       zerion.AddressRouter.String(),
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"),
							Value:    lo.ToPtr(lo.Must(decimal.NewFromString("8036"))),
							Name:     "USD Coin",
							Symbol:   "USDC",
							Decimals: 6,
							Standard: metadata.StandardERC20,
						},
					},
					{
						Type:     typex.ExchangeSwap,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x4F847d8143f948D7572511C6C81BA543289F3baC",
						To:       "0x4F847d8143f948D7572511C6C81BA543289F3baC",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("410000000000000"))),
								Name:     "Ethereum",
								Symbol:   "ETH",
								Decimals: 18,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("1004594"))),
								Name:     "USD Coin",
								Symbol:   "USDC",
								Decimals: 6,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1728761283,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap ETH and USDbC on Base",
			arguments: struct {
				task   *source.Task
				config *config.Module
			}{
				task: &source.Task{
					Network: network.Base,
					ChainID: 8453,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x1cc52b358ffe609bb892b9c447ddd25ef485276b0215d72e8f66cf826edf95ac"),
						ParentHash:   common.HexToHash("0xb9897903f591ef2325941e3229a89ef5609fb778b9f359381dc9aefeeeb7f113"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x4200000000000000000000000000000000000011"),
						Number:       lo.Must(new(big.Int).SetString("20987053", 0)),
						GasLimit:     156000000,
						GasUsed:      31267917,
						Timestamp:    1728763453,
						BaseFee:      lo.Must(new(big.Int).SetString("4136361", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
						From:      common.HexToAddress("0x95555F5c35cd07D7199Bb902302aac80071892c5"),
						Gas:       227420,
						GasPrice:  lo.Must(new(big.Int).SetString("5136361", 10)),
						Hash:      common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
						Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000000000000000000000000000000000000001bcb5100000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000004a0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000002a7647da5b0000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000095555f5c35cd07d7199bb902302aac80071892c5000000000000000000000000e81b24bcd0a706ae3ece36c42cf96c010eeef37a00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000002a7647da5b0000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000edc8f86740daafed0a38f1b73f9964aa5c80901c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
						Value:     lo.Must(new(big.Int).SetString("747000000000000", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("8453", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x1cc52b358ffe609bb892b9c447ddd25ef485276b0215d72e8f66cf826edf95ac"),
						BlockNumber:       lo.Must(new(big.Int).SetString("20987053", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 15191260,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x4e5fe9"),
						GasUsed:           175036,
						L1GasPrice:        lo.Must(new(big.Int).SetString("7781176877", 0)),
						L1GasUsed:         lo.Must(new(big.Int).SetString("4806", 0)),
						L1Fee:             lo.Must(new(big.Int).SetString("84853529808", 0)),

						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0x4200000000000000000000000000000000000006"),
							Topics: []common.Hash{
								common.HexToHash("0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c"),
								common.HexToHash("0x000000000000000000000000e81b24bcd0a706ae3ece36c42cf96c010eeef37a"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000002a7647da5b000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           325,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x4200000000000000000000000000000000000006"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000e81b24bcd0a706ae3ece36c42cf96c010eeef37a"),
								common.HexToHash("0x000000000000000000000000edc8f86740daafed0a38f1b73f9964aa5c80901c"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000002a7647da5b000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           326,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd9aAEc86B65D86f6A7B5B1b0c42FFA531710b6CA"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000edc8f86740daafed0a38f1b73f9964aa5c80901c"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000001c2848"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           327,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xEDc8F86740DAAfED0a38f1b73F9964aa5C80901C"),
							Topics: []common.Hash{
								common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000357d929d058e7230000000000000000000000000000000000000000000000000000000023778ad1"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           328,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xEDc8F86740DAAfED0a38f1b73F9964aa5C80901C"),
							Topics: []common.Hash{
								common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
								common.HexToHash("0x000000000000000000000000e81b24bcd0a706ae3ece36c42cf96c010eeef37a"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000002a7647da5b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c2848"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           329,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd9aAEc86B65D86f6A7B5B1b0c42FFA531710b6CA"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x00000000000000000000000095555f5c35cd07d7199bb902302aac80071892c5"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000001bef13"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           330,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd9aAEc86B65D86f6A7B5B1b0c42FFA531710b6CA"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c7"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000003935"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           331,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
							Topics: []common.Hash{
								common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
								common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
								common.HexToHash("0x000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000002a7647da5b0000000000000000000000000000000000000000000000000000002a7647da5b00000000000000000000000000000000000000000000000000000000000001bcb5100000000000000000000000000000000000000000000000000000000001bef1300000000000000000000000000000000000000000000000000000000000039350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000095555f5c35cd07d7199bb902302aac80071892c50000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000007d20ab6d8af50d87a5e8def46e48f4d7dc2ea5c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000095555f5c35cd07d7199bb902302aac80071892c5000000000000000000000000e81b24bcd0a706ae3ece36c42cf96c010eeef37a00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000002a7647da5b0000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000edc8f86740daafed0a38f1b73f9964aa5c80901c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001"),
							BlockNumber:     lo.Must(new(big.Int).SetString("20987053", 0)),
							TransactionHash: common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
							Index:           332,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728"),
						TransactionIndex: 119,
					},
				},
				config: &config.Module{
					Network: network.Base,
					Endpoint: config.Endpoint{
						URL: endpoint.MustGet(network.Base),
					},
				},
			},
			want: &activityx.Activity{
				ID:       "0xe0c27a243497b0f6641433b59d4dc678caee607fc60e667be02f336ef3302728",
				Network:  network.Base,
				Index:    119,
				From:     "0x95555F5c35cd07D7199Bb902302aac80071892c5",
				To:       zerion.AddressRouter.String(),
				Type:     typex.ExchangeSwap,
				Platform: workerx.PlatformZerion.String(),
				Fee: &activityx.Fee{
					Amount:  lo.Must(decimal.NewFromString("983901613804")),
					Decimal: 18,
				},
				Calldata: &activityx.Calldata{
					FunctionHash: "0x83d13e01",
				},
				Actions: []*activityx.Action{
					{
						Type:     typex.TransactionTransfer,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x95555F5c35cd07D7199Bb902302aac80071892c5",
						To:       zerion.AddressRouter.String(),
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0xd9aAEc86B65D86f6A7B5B1b0c42FFA531710b6CA"),
							Value:    lo.ToPtr(lo.Must(decimal.NewFromString("14645"))),
							Name:     "USD Base Coin",
							Symbol:   "USDbC",
							Decimals: 6,
							Standard: metadata.StandardERC20,
						},
					},
					{
						Type:     typex.ExchangeSwap,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x95555F5c35cd07D7199Bb902302aac80071892c5",
						To:       "0x95555F5c35cd07D7199Bb902302aac80071892c5",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("747000000000000"))),
								Name:     "Ethereum",
								Symbol:   "ETH",
								Decimals: 18,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0xd9aAEc86B65D86f6A7B5B1b0c42FFA531710b6CA"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("1830675"))),
								Name:     "USD Base Coin",
								Symbol:   "USDbC",
								Decimals: 6,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1728763453,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap BNB and USDC on BSC",
			arguments: struct {
				task   *source.Task
				config *config.Module
			}{
				task: &source.Task{
					Network: network.BinanceSmartChain,
					ChainID: 56,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0xb91b236df6cd1b4f364776802f98652e39507a7a3a1beb67a01d010ba5177f04"),
						ParentHash:   common.HexToHash("0xff9936b4187ecfd97e51357fa4a109cb6c7af43f4a1bd0b8c566404acff39fc1"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0xB4647b856CB9C3856d559C885Bed8B43e0846a47"),
						Number:       lo.Must(new(big.Int).SetString("43059653", 0)),
						GasLimit:     140000000,
						GasUsed:      2701768,
						Timestamp:    1728758817,
						BaseFee:      lo.Must(new(big.Int).SetString("0", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
						From:      common.HexToAddress("0x4278a1D211930F7d25F19DB6C56F88013A6054bb"),
						Gas:       368094,
						GasPrice:  lo.Must(new(big.Int).SetString("1000000000", 10)),
						Hash:      common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
						Input:     hexutil.MustDecode("0x83d13e0100000000000000000000000000000000000000000000000000000000000000c00000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d0000000000000000000000000000000000000000000000001fa9f44f6af370a300000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004800000000000000000000000000000000000000000000000000000000000000500000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000e35fa931a00000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004278a1d211930f7d25f19db6c56f88013a6054bb000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d00000000000000000000000000000000000000000000000000000000000000c383bd37f9000000018ac76a51cc950d9822d68b83fe1ad97b32cd580d070e35fa931a0000081ffb2d23a73cb60000831200019b57dca972db5d8866c630554acdbdfe58b2659c00000001d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000301020300060101020e0001010200ff0000000000000000000000000000000000f2688fb5b81049dfb7703ada5e770543770612c4bb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F")),
						Value:     lo.Must(new(big.Int).SetString("4000000000000000", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("56", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0xb91b236df6cd1b4f364776802f98652e39507a7a3a1beb67a01d010ba5177f04"),
						BlockNumber:       lo.Must(new(big.Int).SetString("43059653", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 1808403,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x3b9aca00"),
						GasUsed:           282431,

						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c"),
							Topics: []common.Hash{
								common.HexToHash("0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c"),
								common.HexToHash("0x0000000000000000000000009b57dca972db5d8866c630554acdbdfe58b2659c"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000e35fa931a0000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           45,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000f2688fb5b81049dfb7703ada5e770543770612c4"),
								common.HexToHash("0x00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000001ffb261472621366"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           46,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x0000000000000000000000009b57dca972db5d8866c630554acdbdfe58b2659c"),
								common.HexToHash("0x000000000000000000000000f2688fb5b81049dfb7703ada5e770543770612c4"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000e35fa931a0000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           47,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xf2688Fb5B81049DFB7703aDa5e770543770612C4"),
							Topics: []common.Hash{
								common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
								common.HexToHash("0x0000000000000000000000009b57dca972db5d8866c630554acdbdfe58b2659c"),
								common.HexToHash("0x00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e"),
							},
							Data:            hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffffffe004d9eb8d9dec9a000000000000000000000000000000000000000000000000000e35fa931a000000000000000000000000000000000000000000000aaa3f64c3a3f8c031bd66090000000000000000000000000000000000000000000043f71578fd4866d5f6d6ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff07b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ebbd02800"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           48,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000001ffb261472621366"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           49,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x89b8AA89FDd0507a99d334CBe3C808fAFC7d850E"),
							Topics: []common.Hash{
								common.HexToHash("0x823eaf01002d7353fbcadb2ea3305cc46fa35d799cb0914846d185ac06f8ad05"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000e35fa931a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ffb2614726213660000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580dfffffffffffffffffffffffffffffffffffffffffffffffffffff8f0cb255d660000000000000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           50,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000004278a1d211930f7d25f19db6c56f88013a6054bb"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000001fba2bdf7589eead"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           51,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000d7f1dd5d49206349cae8b585fcb0ce3d96f1696f"),
								common.HexToHash("0x0000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000040fa34fcd824b9"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           52,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xd7F1Dd5D49206349CaE8b585fcB0Ce3D96f1696F"),
							Topics: []common.Hash{
								common.HexToHash("0x5b99554095b82fa9d0725a9ff1f1db8bc3e4d461e7d61911c752c349a47b987f"),
								common.HexToHash("0x000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),
								common.HexToHash("0x0000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000e35fa931a0000000000000000000000000000000000000000000000000000000e35fa931a00000000000000000000000000000000000000000000000000001fa9f44f6af370a30000000000000000000000000000000000000000000000001fba2bdf7589eead0000000000000000000000000000000000000000000000000040fa34fcd824b9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000004278a1d211930f7d25f19db6c56f88013a6054bb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001c6bf5263400000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e54000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004278a1d211930f7d25f19db6c56f88013a6054bb000000000000000000000000c629bf86f02ef13e8f1f5f75ade8a8165587998f000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e00000000000000000000000089b8aa89fdd0507a99d334cbe3c808fafc7d850e00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d00000000000000000000000000000000000000000000000000000000000000c383bd37f9000000018ac76a51cc950d9822d68b83fe1ad97b32cd580d070e35fa931a0000081ffb2d23a73cb60000831200019b57dca972db5d8866c630554acdbdfe58b2659c00000001d7f1dd5d49206349cae8b585fcb0ce3d96f1696f000000000301020300060101020e0001010200ff0000000000000000000000000000000000f2688fb5b81049dfb7703ada5e770543770612c4bb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
							BlockNumber:     lo.Must(new(big.Int).SetString("43059653", 0)),
							TransactionHash: common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
							Index:           53,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79"),
						TransactionIndex: 27,
					},
				},
				config: &config.Module{
					Network: network.BinanceSmartChain,
					Endpoint: config.Endpoint{
						URL: endpoint.MustGet(network.BinanceSmartChain),
					},
				},
			},
			want: &activityx.Activity{
				ID:       "0x6324cf35cfbc46dda7545344b21caeec770915b90c1ffbebec52d407515ddc79",
				Network:  network.BinanceSmartChain,
				Index:    27,
				From:     "0x4278a1D211930F7d25F19DB6C56F88013A6054bb",
				To:       zerion.AddressRouter.String(),
				Type:     typex.ExchangeSwap,
				Platform: workerx.PlatformZerion.String(),
				Fee: &activityx.Fee{
					Amount:  lo.Must(decimal.NewFromString("282431000000000")),
					Decimal: 18,
				},
				Calldata: &activityx.Calldata{
					FunctionHash: "0x83d13e01",
				},
				Actions: []*activityx.Action{
					{
						Type:     typex.TransactionTransfer,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x4278a1D211930F7d25F19DB6C56F88013A6054bb",
						To:       zerion.AddressRouter.String(),
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
							Value:    lo.ToPtr(lo.Must(decimal.NewFromString("18289503996748985"))),
							Name:     "USD Coin",
							Symbol:   "USDC",
							Decimals: 18,
							Standard: metadata.StandardERC20,
						},
					},
					{
						Type:     typex.ExchangeSwap,
						Platform: workerx.PlatformZerion.String(),
						From:     "0x4278a1D211930F7d25F19DB6C56F88013A6054bb",
						To:       "0x4278a1D211930F7d25F19DB6C56F88013A6054bb",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("4000000000000000"))),
								Name:     "BNB",
								Symbol:   "BNB",
								Decimals: 18,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("2286187999593623213"))),
								Name:     "USD Coin",
								Symbol:   "USDC",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1728758817,
			},
			wantError: require.NoError,
		},
	}

	for _, testcase := range testcases {
		testcase := testcase

		t.Run(testcase.name, func(t *testing.T) {
			t.Parallel()

			ctx := context.Background()

			instance, err := worker.NewWorker(testcase.arguments.config)
			require.NoError(t, err)

			activity, err := instance.Transform(ctx, testcase.arguments.task)
			testcase.wantError(t, err)

			// t.Log(string(lo.Must(json.MarshalIndent(activity, "", "\x20\x20"))))

			require.Equal(t, testcase.want, activity)
		})
	}
}
